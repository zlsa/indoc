<!doctype html>
<html>
  <head>
    <title>lib/section.js</title>
    <link rel="stylesheet" href="./../../public/style.css" />
    <link rel="icon" type="image/png" href="./../../public/favicon-32.png" />
    <link rel="icon" type="image/png" href="./../../public/favicon-64.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="./../../public/jquery.min.js"></script>
    <script src="./../../public/script.js"></script>
  </head>
  <body class="code">
    
    <main id="sections">

      <!-- The header -->

        
      <section class="section header files-hidden" id="header">

        <aside class="comment">

          <header>

            <div class="file-path">
              
              
              <a id="project-overview" href="./../.." title="Project Overview">Indoc<span id="version">0.4.19</span></a>
              
              <div class="files-menu">
                <span id="filename" title="lib/section.js">lib/section.js</span>
                
              
                <ul class="files hidable">
                  
                  
<li class="file">
  
<a href="../../CHANGELOG.md" title="CHANGELOG.md">
    
<span class="language" style="background-color: transparent">MD</span>


<span class="filename">CHANGELOG.md</span>

</a>

</li>
  
<li class="file">
  
<a href="../../MARKDOWN.md" title="MARKDOWN.md">
    
<span class="language" style="background-color: transparent">MD</span>


<span class="filename">MARKDOWN.md</span>

</a>

</li>
<li class="file separator">
  
  
<a href="../../bin/main.js" title="bin/main.js">
    
<span class="language" style="background-color: #f1e05a">js</span>


<span class="filename">bin/main.js</span>

</a>

</li>
<li class="file separator">
  
  
<a href="../../examples/example.c" title="examples/example.c">
    
<span class="language" style="background-color: #555555">C</span>


<span class="filename">examples/example.c</span>

</a>

</li>
  
<li class="file">
  
<a href="../../examples/example.html" title="examples/example.html">
    
<span class="language" style="background-color: #e44b23">HTML</span>


<span class="filename">examples/example.html</span>

</a>

</li>
  
<li class="file">
  
<a href="../../examples/example-with-really-really-long-filename.java" title="examples/example-with-really-really-long-filename.java">
    
<span class="language" style="background-color: #b07219">java</span>


<span class="filename">examples/example-with-really-really-long-filename.java</span>

</a>

</li>
  
<li class="file">
  
<a href="../../examples/example.js" title="examples/example.js">
    
<span class="language" style="background-color: #f1e05a">js</span>


<span class="filename">examples/example.js</span>

</a>

</li>
  
<li class="file">
  
<a href="../../examples/example.md" title="examples/example.md">
    
<span class="language" style="background-color: transparent">MD</span>


<span class="filename">examples/example.md</span>

</a>

</li>
  
<li class="file">
  
<a href="../../examples/example.s" title="examples/example.s">
    
<span class="language" style="background-color: #6E4C13">ASM</span>


<span class="filename">examples/example.s</span>

</a>

</li>
<li class="file separator">
  
  
<a href="../class.js" title="lib/class.js">
    
<span class="language" style="background-color: #f1e05a">js</span>


<span class="filename">lib/class.js</span>

</a>

</li>
  
<li class="file">
  
<a href="../events.js" title="lib/events.js">
    
<span class="language" style="background-color: #f1e05a">js</span>


<span class="filename">lib/events.js</span>

</a>

</li>
  
<li class="file">
  
<a href="../file.js" title="lib/file.js">
    
<span class="language" style="background-color: #f1e05a">js</span>


<span class="filename">lib/file.js</span>

</a>

</li>
  
<li class="file">
  
<a href="../language.js" title="lib/language.js">
    
<span class="language" style="background-color: #f1e05a">js</span>


<span class="filename">lib/language.js</span>

</a>

</li>
  
<li class="file">
  
<a href="../main.js" title="lib/main.js">
    
<span class="language" style="background-color: #f1e05a">js</span>


<span class="filename">lib/main.js</span>

</a>

</li>
<li class="file separator">
  
  
<a href="../public/script.js" title="lib/public/script.js">
    
<span class="language" style="background-color: #f1e05a">js</span>


<span class="filename">lib/public/script.js</span>

</a>

</li>
  
<li class="file">
  
<a href="../public/code.scss" title="lib/public/code.scss">
    
<span class="language" style="background-color: #CF649A">SCSS</span>


<span class="filename">lib/public/code.scss</span>

</a>

</li>
  
<li class="file">
  
<a href="../public/footer.scss" title="lib/public/footer.scss">
    
<span class="language" style="background-color: #CF649A">SCSS</span>


<span class="filename">lib/public/footer.scss</span>

</a>

</li>
  
<li class="file">
  
<a href="../public/header.scss" title="lib/public/header.scss">
    
<span class="language" style="background-color: #CF649A">SCSS</span>


<span class="filename">lib/public/header.scss</span>

</a>

</li>
  
<li class="file">
  
<a href="../public/markdown.scss" title="lib/public/markdown.scss">
    
<span class="language" style="background-color: #CF649A">SCSS</span>


<span class="filename">lib/public/markdown.scss</span>

</a>

</li>
  
<li class="file">
  
<a href="../public/reset.scss" title="lib/public/reset.scss">
    
<span class="language" style="background-color: #CF649A">SCSS</span>


<span class="filename">lib/public/reset.scss</span>

</a>

</li>
  
<li class="file">
  
<a href="../public/section.scss" title="lib/public/section.scss">
    
<span class="language" style="background-color: #CF649A">SCSS</span>


<span class="filename">lib/public/section.scss</span>

</a>

</li>
  
<li class="file">
  
<a href="../public/style.scss" title="lib/public/style.scss">
    
<span class="language" style="background-color: #CF649A">SCSS</span>


<span class="filename">lib/public/style.scss</span>

</a>

</li>
  
<li class="file">
  
<a href="../public/values.scss" title="lib/public/values.scss">
    
<span class="language" style="background-color: #CF649A">SCSS</span>


<span class="filename">lib/public/values.scss</span>

</a>

</li>
  
<li class="file">
  
<a href="../public/version.scss" title="lib/public/version.scss">
    
<span class="language" style="background-color: #CF649A">SCSS</span>


<span class="filename">lib/public/version.scss</span>

</a>

</li>
<li class="file separator">
  
  
<a href="../template/file.html" title="lib/template/file.html">
    
<span class="language" style="background-color: #e44b23">HTML</span>


<span class="filename">lib/template/file.html</span>

</a>

</li>
  
<li class="file">
  
<a href="../template/link.html" title="lib/template/link.html">
    
<span class="language" style="background-color: #e44b23">HTML</span>


<span class="filename">lib/template/link.html</span>

</a>

</li>
  
<li class="file">
  
<a href="../template/page.html" title="lib/template/page.html">
    
<span class="language" style="background-color: #e44b23">HTML</span>


<span class="filename">lib/template/page.html</span>

</a>

</li>
  
<li class="file">
  
<a href="../template/section.html" title="lib/template/section.html">
    
<span class="language" style="background-color: #e44b23">HTML</span>


<span class="filename">lib/template/section.html</span>

</a>

</li>

                  
                </ul>
                
              </div>
                
            </div>

            <div class="spacer"></div>
            
            
          </header>
            
        </aside>

        
        <div class="code empty">
        </div>

      </section>

      <!-- The main code section -->
      
      <section class="section">

  
  <aside class="comment empty">
    <div class="text markdown"></div>
  </aside>

  <div class="code">
    <pre><code><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);
<span class="hljs-keyword">const</span> hljs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'highlight.js'</span>);
<span class="hljs-keyword">const</span> marked = <span class="hljs-built_in">require</span>(<span class="hljs-string">'marked'</span>);
<span class="hljs-keyword">const</span> c = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./class'</span>).class;
<span class="hljs-keyword">const</span> merge = <span class="hljs-built_in">require</span>(<span class="hljs-string">'merge'</span>);</code></pre>
  </div>

  
</section>
<section class="section">

  <aside class="comment">
    <div class="text markdown"><p>Helper function to avoid duplication.</p>
</div>
  </aside>
  

  <div class="code">
    <pre><code>exports.markdown = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">text, file</span>) </span>{

  <span class="hljs-keyword">var</span> renderer = <span class="hljs-keyword">new</span> marked.Renderer();

  renderer.heading = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">text, level</span>) </span>{
    <span class="hljs-keyword">var</span> escaped = text.toLowerCase().replace(<span class="hljs-regexp">/&lt;(?:.|\n)*?&gt;/gm</span>, <span class="hljs-string">''</span>).replace(<span class="hljs-regexp">/[^\w]+/g</span>, <span class="hljs-string">'-'</span>);

    <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;h'</span> + level + <span class="hljs-string">' id="'</span> + escaped + <span class="hljs-string">'"&gt;'</span> +
           text + <span class="hljs-string">'&lt;/h'</span> + level + <span class="hljs-string">'&gt;'</span>;
  };</code></pre>
  </div>

  
</section>
<section class="section">

  <aside class="comment">
    <div class="text markdown"><h1 id="project-file-linking">Project file linking</h1><p>You can link to files in the project by prefixing the URL with <code>:</code>.
See <a href="../../MARKDOWN.md/#project-file-linking" title="">MARKDOWN.md</a> for more info.</p>
</div>
  </aside>
  

  <div class="code">
    <pre><code>  renderer.link = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">href, title, text</span>) </span>{
    <span class="hljs-keyword">if</span>(!title) title = <span class="hljs-string">''</span>;</code></pre>
  </div>

  
</section>
<section class="section">

  <aside class="comment">
    <div class="text markdown"><p>Only do this if the link URL starts with <code>:</code></p>
</div>
  </aside>
  

  <div class="code">
    <pre><code>    <span class="hljs-keyword">if</span>(file &amp;&amp; href.startsWith(<span class="hljs-string">':'</span>)) {</code></pre>
  </div>

  
</section>
<section class="section">

  <aside class="comment">
    <div class="text markdown"><p>If the URL contains only <code>:</code>, use the text as the URL</p>
</div>
  </aside>
  

  <div class="code">
    <pre><code>      <span class="hljs-keyword">if</span>(href == <span class="hljs-string">':'</span>) href = text;
      <span class="hljs-keyword">else</span>            href = href.substr(<span class="hljs-number">1</span>);

      <span class="hljs-keyword">var</span> current_path = file.get_link();</code></pre>
  </div>

  
</section>
<section class="section">

  <aside class="comment">
    <div class="text markdown"><p>Remove the ending &#39;/&#39; that <code>file.get_link()</code> returns</p>
</div>
  </aside>
  

  <div class="code">
    <pre><code>      current_path = current_path.substr(<span class="hljs-number">0</span>, current_path.length - <span class="hljs-number">1</span>);</code></pre>
  </div>

  
</section>
<section class="section">

  <aside class="comment">
    <div class="text markdown"><p>Make sure index linking works properly</p>
</div>
  </aside>
  

  <div class="code">
    <pre><code>      <span class="hljs-keyword">if</span>(file.index) current_path = <span class="hljs-string">''</span>;

      <span class="hljs-keyword">var</span> current_dir = path.dirname(current_path);

      <span class="hljs-keyword">var</span> link_filename = href;

      <span class="hljs-keyword">if</span>(!link_filename.startsWith(<span class="hljs-string">'/'</span>))
        link_filename = path.join(current_dir, link_filename);

      <span class="hljs-keyword">if</span>(link_filename.startsWith(<span class="hljs-string">'/'</span>)) link_filename = link_filename.substr(<span class="hljs-number">1</span>);

      <span class="hljs-keyword">var</span> hash = link_filename.split(<span class="hljs-string">'#'</span>);
      
      <span class="hljs-keyword">if</span>(hash.length == <span class="hljs-number">2</span>) {
        link_filename = hash[<span class="hljs-number">0</span>];
        hash = <span class="hljs-string">'#'</span> + hash[<span class="hljs-number">1</span>];
      } <span class="hljs-keyword">else</span> {
        hash = <span class="hljs-string">''</span>;
      }
      
      <span class="hljs-keyword">var</span> link_file = file.project.get_file(link_filename);

      <span class="hljs-keyword">if</span>(link_file) {
        href = path.relative(<span class="hljs-string">'/'</span> + current_path, <span class="hljs-string">'/'</span> + link_file.get_link()) + <span class="hljs-string">'/'</span> + hash;
      } <span class="hljs-keyword">else</span> {
        file.project.emit(<span class="hljs-string">'project-link-err'</span>, {
          <span class="hljs-attr">filename</span>: file.filename,
          <span class="hljs-attr">link</span>: href
        });
        
      }
      
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;a href="'</span> + href + <span class="hljs-string">'" title="'</span> + title + <span class="hljs-string">'"&gt;'</span> + text + <span class="hljs-string">'&lt;/a&gt;'</span>;
  };

  <span class="hljs-keyword">return</span> marked(text, {
    <span class="hljs-attr">renderer</span>: renderer,
    <span class="hljs-attr">highlight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">code, lang</span>) </span>{
      <span class="hljs-keyword">if</span>(!lang)
        <span class="hljs-keyword">return</span> hljs.highlightAuto(code).value;
      <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">return</span> hljs.highlight(lang, code).value;
    },
    <span class="hljs-attr">sanitize</span>: <span class="hljs-literal">true</span>
    
  });
};</code></pre>
  </div>

  
</section>
<section class="section">

  <aside class="comment">
    <div class="text markdown"><p>A section contains a comment and code.</p>
</div>
  </aside>
  

  <div class="code">
    <pre><code>exports.section = c.extend({
  
  <span class="hljs-attr">init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">project, file, language</span>) </span>{
    <span class="hljs-keyword">this</span>.project = project;
    
    <span class="hljs-keyword">this</span>.file = file;</code></pre>
  </div>

  
</section>
<section class="section">

  <aside class="comment">
    <div class="text markdown"><p>The language is set from the file&#39;s language.</p>
</div>
  </aside>
  

  <div class="code">
    <pre><code>    <span class="hljs-keyword">this</span>.language = language;

    <span class="hljs-keyword">this</span>.comment = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">this</span>.comment_markdown = <span class="hljs-string">''</span>;
    
    <span class="hljs-keyword">this</span>.code = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">this</span>.code_highlighted = <span class="hljs-string">''</span>;

    <span class="hljs-keyword">this</span>.code_is_markdown = <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">this</span>.html = <span class="hljs-string">''</span>;
  },

  <span class="hljs-attr">highlight_code</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.code = <span class="hljs-keyword">this</span>.code.replace(<span class="hljs-regexp">/\s+$/g</span>, <span class="hljs-string">''</span>);
    
    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.language.name.hljs == <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">this</span>.code_is_markdown = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">this</span>.code_highlighted = exports.markdown(<span class="hljs-keyword">this</span>.code, <span class="hljs-keyword">this</span>.file);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.language.name.hljs == <span class="hljs-string">'auto'</span>) {
      <span class="hljs-keyword">this</span>.code_highlighted = hljs.highlightAuto(<span class="hljs-keyword">this</span>.code).value;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">this</span>.code_highlighted = hljs.highlight(<span class="hljs-keyword">this</span>.language.name.hljs, <span class="hljs-keyword">this</span>.code).value;
      } <span class="hljs-keyword">catch</span>(e) {
        <span class="hljs-keyword">this</span>.project.emit(<span class="hljs-string">'language-highlight-err'</span>, { <span class="hljs-attr">language</span>: <span class="hljs-keyword">this</span>.language.name.hljs, <span class="hljs-attr">filename</span>: <span class="hljs-keyword">this</span>.file.filename });
        <span class="hljs-keyword">this</span>.code_highlighted = hljs.highlightAuto(<span class="hljs-keyword">this</span>.code).value;
        <span class="hljs-keyword">this</span>.language.name.hljs = <span class="hljs-string">'auto'</span>;
      }
    }
  },

  <span class="hljs-attr">parse_markdown</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.comment_markdown = exports.markdown(<span class="hljs-keyword">this</span>.comment, <span class="hljs-keyword">this</span>.file);
  },

  <span class="hljs-attr">done</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.code = <span class="hljs-keyword">this</span>.code;
    <span class="hljs-keyword">this</span>.comment = <span class="hljs-keyword">this</span>.comment.trim();
    
    <span class="hljs-keyword">this</span>.highlight_code();
    <span class="hljs-keyword">this</span>.parse_markdown();
  },</code></pre>
  </div>

  
</section>
<section class="section">

  <aside class="comment">
    <div class="text markdown"><p>Returns true if both the comment and the code contain no more than whitespace.</p>
</div>
  </aside>
  

  <div class="code">
    <pre><code>  is_empty: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.comment.trim() &amp;&amp; !<span class="hljs-keyword">this</span>.code.trim()) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },

  <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  
    <span class="hljs-keyword">this</span>.html = <span class="hljs-keyword">this</span>.project.templates.section.render(merge(<span class="hljs-keyword">this</span>.project.default_template_data, {
      <span class="hljs-attr">comment_markdown</span>: <span class="hljs-keyword">this</span>.comment_markdown,
      <span class="hljs-attr">code_highlighted</span>: <span class="hljs-keyword">this</span>.code_highlighted
    }));

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.html;

  }
    
});</code></pre>
  </div>

  
</section>

      
      
      <section class="section footer" id="footer">
        
        <aside class="comment">
          <span class="content project-copyright">&copy; Copyright 2018 ZLSA Design.</span>
        </aside>

        <div class="code">
          <span class="content page-generation-time">Generated Tue, 10 Jul 2018 18:04:26 GMT</span>
        </div>
        
      </section>
      
    </main>

  </body>
</html>

